# 🔧 Installer Simple para Python - Windows\n# Versión simplificada y robusta\n\nWrite-Host \"🚀 Instalando dependencias Python para Windows...\" -ForegroundColor Blue\nWrite-Host \"\"\n\n# Verificar ubicación\nif (-not (Test-Path \"requirements.txt\") -and -not (Test-Path \"requirements_windows.txt\")) {\n    Write-Host \"❌ Error: Debes ejecutar este script desde el directorio backend\" -ForegroundColor Red\n    Write-Host \"   Ubicación actual: $(Get-Location)\" -ForegroundColor Yellow\n    Write-Host \"   Uso correcto: cd backend && powershell -File ../scripts/install_python_simple.ps1\" -ForegroundColor Yellow\n    exit 1\n}\n\n# Verificar Python\ntry {\n    $pythonVersion = python --version 2>&1\n    Write-Host \"✅ Python encontrado: $pythonVersion\" -ForegroundColor Green\n}\ncatch {\n    Write-Host \"❌ Python no encontrado\" -ForegroundColor Red\n    Write-Host \"   Instala Python desde: https://python.org\" -ForegroundColor Yellow\n    exit 1\n}\n\n# Actualizar pip\nWrite-Host \"⬆️  Actualizando pip...\" -ForegroundColor Cyan\npython -m pip install --upgrade pip\n\n# Instalar wheel y setuptools\nWrite-Host \"🛠️  Instalando herramientas de build...\" -ForegroundColor Cyan\npython -m pip install wheel setuptools\n\n# Instalar dependencias específicas para Windows (versiones que no requieren compilación)\nWrite-Host \"📦 Instalando dependencias específicas para Windows...\" -ForegroundColor Cyan\n\n$packages = @(\n    \"numpy==1.24.3\",\n    \"pandas==2.0.3\",\n    \"Django==4.2.16\",\n    \"djangorestframework==3.15.2\",\n    \"django-cors-headers==4.3.1\",\n    \"django-environ==0.11.2\",\n    \"psycopg2-binary==2.9.9\",\n    \"celery==5.3.4\",\n    \"redis==5.0.1\",\n    \"openpyxl==3.1.2\",\n    \"Pillow==10.1.0\",\n    \"requests==2.31.0\"\n)\n\nforeach ($package in $packages) {\n    Write-Host \"   Instalando $package...\" -ForegroundColor Gray\n    python -m pip install $package --prefer-binary\n    \n    if ($LASTEXITCODE -eq 0) {\n        Write-Host \"   ✅ $package\" -ForegroundColor Green\n    }\n    else {\n        Write-Host \"   ⚠️  Error con $package (continuando...)\" -ForegroundColor Yellow\n    }\n}\n\n# Intentar instalar desde requirements si existe\nif (Test-Path \"requirements_windows.txt\") {\n    Write-Host \"📋 Instalando desde requirements_windows.txt...\" -ForegroundColor Cyan\n    python -m pip install -r requirements_windows.txt --prefer-binary\n}\nelseif (Test-Path \"requirements.txt\") {\n    Write-Host \"📋 Instalando desde requirements.txt...\" -ForegroundColor Cyan\n    python -m pip install -r requirements.txt --prefer-binary\n}\n\n# Verificar instalaciones críticas\nWrite-Host \"🔍 Verificando instalaciones críticas...\" -ForegroundColor Cyan\n\n$tests = @(\n    @{ Name = \"Django\"; Command = \"import django; print('Django:', django.__version__)\" },\n    @{ Name = \"Pandas\"; Command = \"import pandas; print('Pandas:', pandas.__version__)\" },\n    @{ Name = \"NumPy\"; Command = \"import numpy; print('NumPy:', numpy.__version__)\" }\n)\n\nforeach ($test in $tests) {\n    try {\n        $result = python -c $test.Command 2>&1\n        if ($LASTEXITCODE -eq 0) {\n            Write-Host \"   ✅ $($test.Name): $result\" -ForegroundColor Green\n        }\n        else {\n            Write-Host \"   ❌ $($test.Name): Error\" -ForegroundColor Red\n        }\n    }\n    catch {\n        Write-Host \"   ❌ $($test.Name): No instalado\" -ForegroundColor Red\n    }\n}\n\n# Mostrar resumen\nWrite-Host \"\"\nWrite-Host \"📊 Resumen de paquetes instalados:\" -ForegroundColor Blue\n$packageList = python -m pip list 2>&1\nif ($LASTEXITCODE -eq 0) {\n    $count = ($packageList | Measure-Object -Line).Lines - 2\n    Write-Host \"   Total: $count paquetes\" -ForegroundColor Green\n}\n\nWrite-Host \"\"\nWrite-Host \"🎉 Instalación completada!\" -ForegroundColor Green\nWrite-Host \"   Próximos pasos:\" -ForegroundColor Cyan\nWrite-Host \"   1. cd ..\" -ForegroundColor Gray\nWrite-Host \"   2. npm run docker:up\" -ForegroundColor Gray\nWrite-Host \"   3. npm run backend:dev\" -ForegroundColor Gray\nWrite-Host \"\"\n\nexit 0